
#english

server
{
    listen 80;
    server_name www.dev.com ;
    index index.php;
    root  /data/php-webapp/app_www/web;
    ssi on;
    ssi_silent_errors on;
    ssi_types text/shtml;

    #for multi language auto redirect
    location  = / {
        alias /data/Orion/static/;
        index index.html;

        #include /data/docker-compose/nginx/vhost/ip.common;

        set $newhomepage "0";
        if ($cookie_visitednhp = "1")
        {
            set $newhomepage "1";
        }

        set $lang "1";
        if ($cookie_lang ~* ^en)
        {
            set $lang "2";
        }
        if ($cookie_lang ~* ^zh)
        {
            set $lang "${lang}2";
        }
        if ($http_accept_language ~* ^zh) {
            set $lang "${lang}3";
        }
        set $lang "${lang}${newhomepage}";

        if ($lang = "120") {
            rewrite ^ /cn/page/ redirect;
        }
        if ($lang = "121") {
            rewrite ^ /cn/ redirect;
        }
        if ($lang = "130") {
            rewrite ^ /cn/page/ redirect;
        }
        if ($lang = "131") {
            rewrite ^ /cn/ redirect;
        }
        if ($lang = "1230") {
            rewrite ^ /cn/page/ redirect;
        }
        if ($lang = "1231") {
            rewrite ^ /cn/ redirect;
        }
        #language is en-us
        if ($newhomepage = "1") {
            rewrite ^ /en/ redirect;
        }
    }
    #for multi language auto redirect -- end

       location = /en {
            root /var/www/superbuy/test/Orion/static/;
            try_files $uri /en/page/homepage/index.html;
        }
        location = /en/ {
            root /var/www/superbuy/test/Orion/static/;
            try_files $uri /en/page/homepage/index.html;
        }
        location = /cn {
            root /var/www/superbuy/test/Orion/static/;
            try_files $uri /cn/page/homepage/index.html;
        }
        location = /cn/ {
            root /var/www/superbuy/test/Orion/static/;
            try_files $uri /cn/page/homepage/index.html;
        }

    location ^~ /cn/page/account/ {
        try_files $uri /cn/page/account/index.html;
        root  /data/Orion/static;
    }
    location ^~ /en/page/account/ {
        try_files $uri /en/page/account/index.html;
        root  /data/Orion/static;
    }

    location ^~ /cn/page/partner/ {
        try_files $uri /cn/page/partner/index.html;
        root   /data/Orion/static;
    }
    location ^~ /en/page/partner/ {
        try_files $uri /en/page/partner/index.html;
        root   /data/Orion/static;
    }
    location ^~ /upload {
        alias /data/php-webapp/app_www/web/upload;
        index index.php index.html index.htm;
    }

    location = /cn/page/ {
        alias /data/Orion/static/;
        index index.html;
        rewrite ^ /cn/ redirect;
    }
    location = /en/page/ {
        alias /data/Orion/static/;
        index index.html;
        rewrite ^ /en/ redirect;
    }
#    #for cookie language auto redirect.end

# send crawler token
    location ^~ /cn/page/buy/selfservice {
        index index.html;
        alias /data/Orion/static/cn/page/buy/selfservice;
    }
    location ^~ /cn/page/buy {
        index index.php;
        root  /data/php-webapp/app_www/web;
        rewrite ^/(.*)([/]+)$ $scheme://$host/$1 redirect;
        rewrite ^  /index.php?$args;
    }
    location ^~ /en/page/buy/selfservice {
        index index.html;
        alias /data/Orion/static/en/page/buy/selfservice;
    }
    location ^~ /en/page/buy {
        index index.php;
        root  /data/php-webapp/app_www/web;
        rewrite ^/(.*)([/]+)$ $scheme://$host/$1 redirect;
        rewrite ^  /index.php?$args;
    }
# send crawler token.end
    location / {
        #/data/Orion 是前端静态文件目录
        # http://labs.oa.com/front-end/Orion.git
        # development branch
        alias /data/Orion/static/;
        index index.html;

        include /data/docker-compose/nginx/vhost/ip.common;
        #try_files $uri $uri/ @php;
        error_page 404 = @php;

    }

    location @php {
        #rewrite ^/(.*)([^/])$ $scheme://$host/$1$2/ permanent;
        rewrite ^/(.*)([/]+)$ $scheme://$host/$1 redirect;
        rewrite ^ /index.php?$args;
    }

    #error_page   404   /404.html;

    include /data/docker-compose/nginx/php.conf;
    
    location /assets {
        alias /data/php-webapp/app_www/web/assets;
    }
    
    location /views {
        alias /data/webapp-static-superbuy/dotdotbuy/views;
    }
    
    location ^~ /js/ {
        alias /data/webapp-static-superbuy/static/front/js/;
        ##concat on;
        #expires 30d;
        break;
        }

    location ~* .*\.(gif|jpg|jpeg|png|bmp|swf)$ {
        root   /data/Orion/static/;
        expires 10d;
    }
#        location ~ .*\.(gif|jpg|jpeg|png|bmp|swf)$
#        {
#            expires      30d;
#        }

#        location ~ .*\.(js|css)?$
#        {
#            expires      12h;
#        }

#        location ~ /\.
#        {
#            deny all;
#        }

#    access_log off;
    access_log  /data/docker-compose/nginx/logs/access_dev_www.log  logstash_json;
}

server
{
    listen 80;
    server_name www.test.com  ;
    index index.php;
    root  /data/superbuy/php-webapp/app_www/web;
    ssi on;
    ssi_silent_errors on;
    ssi_types text/shtml;

    #for multi language auto redirect
    location  = / {
        alias /data/superbuy/Orion/static/;
        index index.html;

        #include /data/docker-compose/nginx/vhost/ip.common;

        set $newhomepage "0";
        if ($cookie_visitednhp = "1")
        {
            set $newhomepage "1";
        }

        set $lang "1";
        if ($cookie_lang ~* ^en)
        {
            set $lang "2";
        }
        if ($cookie_lang ~* ^zh)
        {
            set $lang "${lang}2";
        }
        if ($http_accept_language ~* ^zh) {
            set $lang "${lang}3";
        }
        set $lang "${lang}${newhomepage}";

        if ($lang = "120") {
            rewrite ^ /cn/page/ redirect;
        }
        if ($lang = "121") {
            rewrite ^ /cn/ redirect;
        }
        if ($lang = "130") {
            rewrite ^ /cn/page/ redirect;
        }
        if ($lang = "131") {
            rewrite ^ /cn/ redirect;
        }
        if ($lang = "1230") {
            rewrite ^ /cn/page/ redirect;
        }
        if ($lang = "1231") {
            rewrite ^ /cn/ redirect;
        }
        #language is en-us
        if ($newhomepage = "1") {
            rewrite ^ /en/ redirect;
        }
    }
    #for multi language auto redirect -- end

       location = /en {
            root /var/www/superbuy/php-webapp/test/Orion-superbuy/static/;
            try_files $uri /en/page/homepage/index.html;
        }
        location = /en/ {
            root /var/www/superbuy/php-webapp/test/Orion-superbuy/static/;
            try_files $uri /en/page/homepage/index.html;
        }
        location = /cn {
            root /var/www/superbuy/php-webapp/test/Orion-superbuy/static/;
            try_files $uri /cn/page/homepage/index.html;
        }
        location = /cn/ {
            root /var/www/superbuy/php-webapp/test/Orion-superbuy/static/;
            try_files $uri /cn/page/homepage/index.html;
        }

    location ^~ /cn/page/account/ {
        try_files $uri /cn/page/account/index.html;
        root  /data/superbuy/Orion/static;
    }
    location ^~ /en/page/account/ {
        try_files $uri /en/page/account/index.html;
        root  /data/superbuy/Orion/static;
    }

    location ^~ /cn/page/partner/ {
        try_files $uri /cn/page/partner/index.html;
        root   /data/superbuy/Orion/static;
    }
    location ^~ /en/page/partner/ {
        try_files $uri /en/page/partner/index.html;
        root   /data/superbuy/Orion/static;
    }
    location ^~ /upload {
        alias /data/superbuy/php-webapp/app_www/web/upload;
        index index.php index.html index.htm;
    }

    location = /cn/page/ {
        alias /data/superbuy/Orion/static/;
        index index.html;
        rewrite ^ /cn/ redirect;
    }
    location = /en/page/ {
        alias /data/superbuy/Orion/static/;
        index index.html;
        rewrite ^ /en/ redirect;
    }
#    #for cookie language auto redirect.end

# send crawler token
    location ^~ /cn/page/buy/selfservice {
        index index.html;
        alias /data/superbuy/Orion/static/cn/page/buy/selfservice;
    }
    location ^~ /cn/page/buy {
        index index.php;
        root  /data/superbuy/php-webapp/app_www/web;
        rewrite ^/(.*)([/]+)$ $scheme://$host/$1 redirect;
        rewrite ^  /index.php?$args;
    }
    location ^~ /en/page/buy/selfservice {
        index index.html;
        alias /data/superbuy/Orion/static/en/page/buy/selfservice;
    }
    location ^~ /en/page/buy {
        index index.php;
        root  /data/superbuy/php-webapp/app_www/web;
        rewrite ^/(.*)([/]+)$ $scheme://$host/$1 redirect;
        rewrite ^  /index.php?$args;
    }
# send crawler token.end
    location / {
        #/data/Orion 是前端静态文件目录
        # http://labs.oa.com/front-end/Orion.git
        # development branch
        alias /data/superbuy/Orion/static/;
        index index.html;

        include /data/docker-compose/nginx/vhost/ip.common;
        #try_files $uri $uri/ @php;
        error_page 404 = @php;

    }

    location @php {
        #rewrite ^/(.*)([^/])$ $scheme://$host/$1$2/ permanent;
        rewrite ^/(.*)([/]+)$ $scheme://$host/$1 redirect;
        rewrite ^ /index.php?$args;
    }

    #error_page   404   /404.html;

    include /data/docker-compose/nginx/php.conf;
    
    location /assets {
        alias /data/superbuy/php-webapp/app_www/web/assets;
    }
    
    location /views {
        alias /data/webapp-static-superbuy/dotdotbuy/views;
    }
    
    location ^~ /js/ {
        alias /data/webapp-static-superbuy/static/front/js/;
        ##concat on;
        #expires 30d;
        break;
        }

    location ~* .*\.(gif|jpg|jpeg|png|bmp|swf)$ {
        root   /data/superbuy/Orion/static/;
        expires 10d;
    }
#        location ~ .*\.(gif|jpg|jpeg|png|bmp|swf)$
#        {
#            expires      30d;
#        }

#        location ~ .*\.(js|css)?$
#        {
#            expires      12h;
#        }

#        location ~ /\.
#        {
#            deny all;
#        }

#    access_log off;
    access_log  /data/docker-compose/nginx/logs/access_dev_www.log  logstash_json;
}

server
{
    listen 80;
    server_name www.sw.com;
    index index.html;
    ssi on;
    root  /data/php-swoole/app_www/web;

    location / {
        #/data/Orion 是前端静态文件目录
        # http://labs.oa.com/front-end/Orion.git
        # development branch
        alias /data/Orion/static/;
        index index.html;

        include /data/docker-compose/nginx/vhost/ip.common;
        #try_files $uri $uri/ @php;
        #error_page 404 = @php;

    }

    location ~* ^/(ajax|order|account|debug|payment)(.*)$ {
#        try_files $uri $uri/ /index.php?$args;
        include /data/docker-compose/nginx/proxy.header;
        #if (!-e $request_filename) {
            proxy_pass http://php7:8001;
        #}
    }

    #error_page   404   /404.html;

    location /assets {
        alias /data/php-swoole/app_www/web/assets;
    }
    
    location /views {
        alias /data/webapp-static-superbuy/dotdotbuy/views;
    }
    
    location ^~ /js/ {
        alias /data/webapp-static-superbuy/static/front/js/;
        ##concat on;
        #expires 30d;
        break;
        }


#    include /data/docker-compose/nginx/php.conf;

#    access_log off;
    access_log  /data/docker-compose/nginx/logs/access_sw_www.log  logstash_json;
}

server
{
    listen 80;
    server_name www.beta.com;
    index index.php;
    root  /data/php-master/app_www/web;
    ssi on;
    ssi_silent_errors on;
    ssi_types text/shtml;

    location / {
        alias /data/Orion/static/;
        index index.html;

        #try_files $uri $uri/ @php;
        error_page 404 = @php;
    }
    location @php {
        rewrite ^ /index.php?$args;
    }

    #error_page   404   /404.html;


    include /data/docker-compose/nginx/php.conf;
    
    location /assets {
        alias /data/php-master/app_www/web/assets;
    }
    
    location /views {
        alias /data/webapp-static-superbuy/dotdotbuy/views;
    }
    
    location ^~ /js/ {
        alias /data/webapp-static-superbuy/static/front/js/;
        ##concat on;
        #expires 30d;
        break;
    }

    location ^~/cn/page/account/ {
        try_files $uri /cn/page/account/index.html;
        root  /data/Orion/static;
    }
    location ^~/en/page/account/ {
        try_files $uri /en/page/account/index.html;
        root  /data/Orion/static;
    }
        
    location ^~ /html/ {
        ssi on;
        ssi_silent_errors on;
        ssi_types text/shtml;
        alias /data/webapp-static-superbuy/static/front/html/;
        #concat on;
        break;
    }

    location ^~ /console {
        index index.html;
        alias /data/middle_console/dist;
        break;
    }
    location ~* .*\.(gif|jpg|jpeg|png|bmp|swf)$ {
        root   /data/Orion/static/;
        expires 10d;
    }
#        location ~ .*\.(gif|jpg|jpeg|png|bmp|swf)$
#        {
#            expires      30d;
#        }

#        location ~ .*\.(js|css)?$
#        {
#            expires      12h;
#        }

#        location ~ /\.
#        {
#            deny all;
#        }

        access_log off;
}